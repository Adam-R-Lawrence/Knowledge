<!--
title: Mathematics
tags: [math]
-->

## Mathematics

Brief notes on mathematical concepts, definitions, and problem-solving.

### Inner Product
- Bilinear (or sesquilinear) pairing `<u,v>` that turns a vector space into a geometry: linear in each slot, symmetric (or conjugate symmetric), and positive definite so `<v,v> > 0` when `v != 0`.
- Induces a norm `||v|| = sqrt(<v,v>)` and angle notions; orthogonality is `<u,v> = 0`.
- Choosing a suitable inner product is fundamental for defining energy norms and weak formulations.

### Metric Space
- A set `X` with a distance function `d: X × X → [0,∞)` satisfying symmetry, triangle inequality, and `d(x,y) = 0 iff x = y`.
- Convergence, continuity, and completeness depend only on `d`, so metric spaces abstract topology generated by distances.
- Examples: Euclidean space with `d(x,y) = ||x - y||`, function spaces with sup or integral norms.

### Hilbert Space
- A complete inner-product space; every Cauchy sequence converges in `V`.
- Typical examples: `ℝ^n`, sequence space `ℓ^2`, and Sobolev space `H^1(Ω)`.
- Key features: orthogonal projections exist, and many PDE existence proofs (e.g., Lax–Milgram) live in this setting.

### Null Space
- The kernel `ker(A) = {x : A x = 0}` for a linear map `A`; captures directions that the operator cannot distinguish.
- Dimension is the nullity; fundamental for solvability (`b` must be orthogonal to the left null space) and conditioning.
- In PDE contexts, null spaces often encode symmetries (e.g., rigid body modes, gauge freedoms).

### Tensor
- Multi-linear map that transforms predictably under coordinate changes; orders correspond to the number of covariant/contravariant indices.
- Provides coordinate-free descriptions of physical quantities (stress, strain, inertia) so results remain objective regardless of basis.
- In ℝⁿ, tensors can be represented by arrays whose components obey transformation rules `T' = Q T Q^T` (second order) when rotating coordinates.
- Tensor operations—contraction, outer product, tensor product—extend familiar vector/matrix algebra to higher-order objects.

### Gauge Invariance
- Redundancy in field variables where physically measurable quantities stay unchanged under local transformations.
- Electromagnetism: potentials obey `A → A + ∇χ`, `φ → φ - ∂_t χ`, leaving `E` and `B` intact; similar ideas appear in fluid pressure, vector potentials, and Yang–Mills theories.
- Gauge fixing (e.g., Lorenz gauge) removes the null directions to make equations solvable numerically.

### Krylov Space
- For matrix `A` and vector `r0`, the order-`m` subspace `K_m(A, r0) = span{r0, A r0, ..., A^{m-1} r0}`.
- Iterative methods (GMRES, CG, BiCGStab) search for solutions within growing Krylov subspaces while keeping residuals small.
- Orthogonalization and preconditioning determine numerical stability and convergence speed.

### Condition Number
- Measures sensitivity of a problem to perturbations: `κ(A) = ||A|| · ||A^{-1}||`, equal to the ratio of largest to smallest singular value in 2-norm.
- Large `κ` implies small input or coefficient errors can cause large solution changes; ill-conditioned systems challenge numerical solvers.
- Preconditioning aims to reduce `κ` to improve convergence of iterative methods and stability of direct factorizations.
- Also used for nonlinear problems via Jacobians: monitor `κ(J)` to detect near-singular configurations or bifurcations.

### Dual Space `V'`
- All continuous linear functionals on a normed space `V`, with norm `||f|| = sup_{||v||=1} |f(v)|`.
- In PDE, boundary fluxes, loads, or source terms often live in `V'` so they can act on test functions in `V`.
- Pairings `<f, v>` denote action of the functional on `v`; the Riesz map ties `V'` back to `V` for Hilbert spaces.

### Cauchy-Schwarz Inequality
- For any `u, v` in an inner-product space, `|<u, v>| ≤ ||u|| ||v||`, with equality iff `u` and `v` are linearly dependent.
- Guarantees norm induced by an inner product satisfies the triangle inequality; underpins error bounds and stability estimates.
- Provides cosine of the angle between `u` and `v` via `cos theta = <u, v> / (||u|| ||v||)`.

### Riesz Representation Theorem
- In a Hilbert space `V`, every `f ∈ V'` corresponds to a unique `w ∈ V` such that `f(v) = <v, w>` for all `v ∈ V`.
- Establishes an isometric isomorphism between `V` and its dual, enabling identification of forces/loads with elements of `V`.
- Essential for deriving weak forms: functionals in `V'` can be expressed as inner products with representative functions.

### Argmin Operation
- Returns the point where a function attains its minimum value: `argmin_{x in X} f(x)`.
- Defines optimal solutions in variational problems, statistics, and machine learning.
- Existence typically needs coercivity and lower semicontinuity so minimizing sequences converge.

### Hessian
- Square matrix of second partial derivatives `H_ij = d^2 f / (dx_i dx_j)` for a scalar field `f`.
- Captures curvature; positive definite Hessian at a critical point implies a strict local minimum for smooth `f`.
- Used in Newton updates, stability analysis, and second-order optimization methods.

### Implicit Function
- Relationship defined indirectly by an equation `F(x, y) = 0` instead of explicit `y = f(x)` form; solutions lie on the level set of `F`.
- Implicit function theorem: If `∂F/∂y` is nonzero near a point, one can locally solve for `y(x)` with derivatives obtained via implicit differentiation.
- Applications: Constraining optimization problems, tracking phase equilibria, or defining manifolds without closed-form parameterizations.

### Interpolation
- Builds a function that matches known samples and estimates values between them.
- Polynomial, spline, and radial basis interpolants trade smoothness, accuracy, and conditioning.
- In PDE numerics, interpolation transfers solutions across meshes or couples multi-physics fields.

### Barycentric Coordinates
- Express a point inside a simplex as weights on the vertices with weights summing to one.
- Provide simple interpolation formulas on triangles and tetrahedra and enable fast point-in-element tests.
- Shape functions for simplex finite elements are exactly the barycentric coordinates.

### Gradient Operator
- Maps a scalar field to its vector of partial derivatives `grad f = (df/dx_1, ..., df/dx_n)`.
- Points along the direction of steepest ascent; magnitude equals the maximum directional derivative.
- Drives flux laws, optimization steps, and weak-form derivations via integration by parts.

### Laplacian Operator
- Second-order differential operator `Delta f = div(grad f)`; in Cartesian axes `sum_i d^2 f / dx_i^2`.
- Models diffusion, electrostatics, and vibration; harmonic functions satisfy `Delta f = 0`.
- Discretized through finite differences, finite elements, or spectral methods depending on geometry.

### Div Operator
- Divergence of a vector field `u`: `div u = sum_i d u_i / dx_i`.
- Measures net outflow density; positive divergence signals sources, negative divergence signals sinks.
- Enforces conservation laws such as incompressibility and Gauss-type constraints.

### Crank-Nicolson Method
- Second-order, unconditionally stable time integrator that averages explicit and implicit Euler.
- For `u_t = L u`, solve `(I - dt/2 L) u^{n+1} = (I + dt/2 L) u^n` each step.
- Common for parabolic PDEs; may need stabilization to control oscillations around sharp gradients.

### Least Squares
- Minimizes the sum of squared residuals `min_x ||A x - b||_2^2` to fit data or enforce equations.
- Leads to normal equations `A^T A x = A^T b` or QR-based solutions for better conditioning.
- Foundation for regression, data assimilation, and least-squares finite element formulations.

### Dirichlet Boundary Condition (BC)
- Prescribes the value of a field on the boundary, e.g., `u = g` on `∂Ω`; called an essential boundary condition in weak form.
- In finite elements, test/trial spaces incorporate the constraint by fixing nodal values or lifting known data.
- Physically corresponds to clamped displacement, fixed temperature, prescribed potential, etc.

### Neumann BC
- Fixes the normal derivative or flux: `∂u/∂n = h` or stress `σn = t`; a natural boundary condition in weak form.
- Appears as boundary integrals after integration by parts and does not constrain the solution space directly.
- Often used for insulated walls (`∂T/∂n = 0`) or prescribed traction loads.

### Robin BC
- Linear combination of Dirichlet and Neumann data: `α u + β ∂u/∂n = g` on `∂Ω`.
- Models convective heat transfer, radiation, or spring-like support by blending value and flux information.
- In weak form, contributes both to stiffness and load terms through boundary integrals.

### Do-Nothing BC
- Outflow boundary condition from the weak form of Navier-Stokes: sets traction equal to ambient pressure while leaving normal velocity free.
- Derived by leaving the natural boundary term untouched; convenient but can destabilize if backflow occurs.
- Often combined with stabilization or sponge layers to control reflections at artificial outlets.

### No Penetration BC
- Imposes zero normal component, typically `u · n = 0`, preventing flow or displacement through the boundary.
- Used for impermeable walls in fluids or contact-free but sealed surfaces in elasticity.
- Usually paired with additional tangential conditions (no-slip, slip, or traction).

### No Traction BC
- Also called traction-free or stress-free: sets the full traction vector `σ n = 0` on the boundary.
- For fluids, equivalent to zero normal stress and zero shear stress, allowing free outflow or free surfaces.
- In elasticity, models a free surface with no applied loads.

### Convective BC
- Describes flux proportional to the difference between surface and ambient values: `-k ∂T/∂n = h (T - T_∞)`.
- Captures Newton cooling/heating, radiative losses (linearized), or convective mass transfer.
- Leads to Robin-type boundary terms in variational formulations.

### Navier Slip BC
- Relates tangential velocity to tangential traction: `u_t = l_s (σ n)_t`, with slip length `l_s`.
- Bridges no-slip (`l_s → 0`) and perfect slip (`l_s → ∞`); used for microfluidics or wall functions.
- Requires zero normal velocity to maintain impermeability.

### Perfect Slip BC
- Limiting case of Navier slip with zero tangential traction and zero normal flow, so tangential velocity is unconstrained.
- Models frictionless contact between fluid and boundary or symmetry planes.
- Maintains shear-free condition, preventing vorticity generation at the wall.

### Free Slip BC
- Same impermeability as no-penetration plus vanishing shear stress: `u · n = 0`, `(σ n)_t = 0`.
- Allows tangential flow without friction, commonly used at symmetry boundaries or large-scale atmospheric/oceanic models.
- When used as a symmetry plane, tangential velocity is mirrored so `∂_n u_t = 0`, effectively reflecting the solution across the boundary.

### GLL Nodes
- Gauss-Lobatto-Legendre points include the interval endpoints and interior roots of `(1 - x^2) P_n'(x) = 0`, where `P_n` is the Legendre polynomial.
- Provide interpolation nodes for spectral element methods that retain high-order accuracy and enable diagonal mass matrices with appropriate quadrature.
- Clustering near boundaries reduces Runge oscillations and supports stable high-order approximations.

### Weak Derivative
- A way to talk about a “derivative” for rough functions by testing how they behave inside integrals with smooth probe functions; sharp corners and jumps are allowed.
- Idea: Define derivatives via integration against smooth test functions when classical derivatives may not exist.
- 1D definition: A function `w ∈ L^1_loc` is the weak derivative of `u` if for all `φ ∈ C_c^∞(a,b)`,
  `∫_a^b u(x) φ'(x) dx = - ∫_a^b w(x) φ(x) dx`.
- Multi-D: For multi-index `α`, `D^α u` is weak derivative if `∫_Ω u D^α φ = (-1)^{|α|} ∫_Ω (D^α u) φ` for all `φ ∈ C_c^∞(Ω)`.
- Context: Underpins Sobolev spaces `W^{k,p}` and weak formulations of PDEs.

### Integration by Parts
- Trade a derivative from one factor to the other inside an integral, plus a boundary term—think “product rule for integrals.”
- 1D: `∫_a^b u'(x) v(x) dx = [u v]_a^b - ∫_a^b u(x) v'(x) dx`.
- Multi-D (one form): For sufficiently smooth `u` and vector field `w`,
  `∫_Ω ∇u · w dx = - ∫_Ω u (∇·w) dx + ∫_{∂Ω} u (w·n) ds`.
- Weak forms: Boundary terms encode natural/essential boundary conditions depending on which functions vanish on `∂Ω`.

### Test Functions
- Smooth little “bump” functions that are zero near the boundary; safe probes to test other functions without causing trouble at the edges.
- Definition: Infinitely differentiable functions with compact support inside the domain, `C_c^∞(Ω)`.
- Role: Probe distributions/weak derivatives via duality; often chosen to vanish on the boundary to eliminate boundary terms.
- Spaces: The space of test functions is dense in many function spaces and defines distributions as continuous linear functionals on it.

### Jump Discontinuity
- A step change—values just before and after a point (or across a surface) differ; the jump is their difference.
- 1D: A point `x0` where left and right limits exist but differ: `u(x0^-) ≠ u(x0^+)`.
- Across an interface `Γ` in multi-D: The jump is `[u] = u^+ - u^-`, with `u^±` denoting traces from each side of `Γ` along the normal.
- Notes: Jumps appear in piecewise-defined solutions, shocks, or discontinuous Galerkin methods; derivatives may contain measures (e.g., Dirac terms) at jumps.

### Lax–Milgram Theorem
- If your energy-like bilinear form is well-behaved (bounded) and strongly positive (coercive), then your linear problem has exactly one solution and small input changes cause only small solution changes.
- Setting: Hilbert space `V`, continuous bilinear form `a(·,·): V×V→ℝ` (or `ℂ`) and continuous linear functional `f: V→ℝ`.
- Continuity (boundedness): `|a(u,v)| ≤ M ||u||_V ||v||_V` for some `M > 0` and all `u,v ∈ V`.
- Coercivity (ellipticity): `a(v,v) ≥ α ||v||_V^2` for some `α > 0` and all `v ∈ V`.
- Conclusion: There exists a unique `u ∈ V` such that `a(u,v) = f(v)` for all `v ∈ V`, with stability bound `||u||_V ≤ ||f||_{V'} / α`.
- Use: Guarantees well-posedness of weak formulations of many elliptic boundary value problems.

### Advection PDE
- Transports a quantity without smoothing; information moves along characteristics at a speed.
- 1D linear form: `u_t + a u_x = 0` with constant advection speed `a`; solution is a shift: `u(x,t) = u0(x - a t)`.
- Features: Preserves shape in the continuous model; numerical schemes must control dispersion/dissipation (CFL condition).

### Diffusion PDE
- Spreads/smooths a quantity over time; high frequencies decay fastest.
- 1D heat equation: `u_t = κ u_xx` with diffusivity `κ > 0`; fundamental solution is Gaussian with variance `2 κ t`.
- Features: Conserves total mass (with appropriate boundaries); solutions become smoother instantly for `t > 0`.

### Generalized-Alpha Method
- Family of second-order, unconditionally stable time integrators that add controllable high-frequency damping for ODEs/structural dynamics.
- Parameters via spectral radius at infinity `ρ∞ ∈ [0,1]` (0 = max damping, 1 = no extra damping):
  `α_m = (2 ρ∞ - 1)/(ρ∞ + 1)`, `α_f = ρ∞/(ρ∞ + 1)`, `γ = 1/2 + α_f - α_m`, `β = (1/4) (1 + α_f - α_m)^2`.
- Use: Choose `ρ∞ ≈ 0.5–0.8` to damp spurious high-frequency response while keeping low-frequency accuracy.

### Lp Norms (ℓ2, ℓ∞)
- For a vector `x ∈ ℝ^n` and `p ≥ 1`: `||x||_p = (∑ |x_i|^p)^{1/p}`; measures size with different sensitivity to components.
- ℓ2 (Euclidean): `||x||_2 = (∑ x_i^2)^{1/2}`; rotation-invariant; common in least-squares.
- ℓ∞ (max norm): `||x||_∞ = max_i |x_i|`; limit of `||·||_p` as `p → ∞`.
- All `||·||_p` satisfy positivity, homogeneity, and triangle inequality; different norms are equivalent up to constants in finite dimensions.

### Newton's Method
- Root finding for `f(x) = 0` using local linearization; iterate `x_{k+1} = x_k - f(x_k)/f'(x_k)` (scalar) or `x_{k+1} = x_k - J_f(x_k)^{-1} f(x_k)` (multivariate).
- Convergence: Quadratic near a simple root with a good initial guess; may diverge if started too far or with poor conditioning.
- Practicalities: Use damping/line search and solve the Newton system with direct or iterative linear solvers; reuse/precondition Jacobians when possible.

### Picard (Fixed-Point) Method
- Solve `x = g(x)` by iteration `x_{k+1} = g(x_k)`; derivative-free and simple.
- Convergence: Linear when `g` is a contraction (`||g'(x)|| < 1` in a suitable norm); slower than Newton but robust for some nonlinearities.
- Use: Common for nonlinear PDE discretizations (e.g., implicit diffusion/advection-reaction) and as a preconditioner or initializer for Newton.
